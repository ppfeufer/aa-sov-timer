$(document).ready(()=>{'use strict';let a=sovtimerJsSettingsDefaults;'undefined'!=typeof sovtimerJsSettingsOverride&&(a=objectDeepMerge(sovtimerJsSettingsDefaults,sovtimerJsSettingsOverride));const t={campaignsTotal:$('.aa-sovtimer-campaigns-total'),campaignsUpcoming:$('.aa-sovtimer-campaigns-upcoming'),campaignsActive:$('.aa-sovtimer-campaigns-active')},e=a=>{let t='',e='aa-sovtimer-remaining';a<0?(e+=' aa-sovtimer-timer-elapsed',t='-',a=Math.abs(a)+1):a--;return{countdown:`<span class="${e}">${t}${Math.floor(a/86400)}d ${String(Math.floor(a/3600)%24).padStart(2,'0')}h ${String(Math.floor(a/60)%60).padStart(2,'0')}m ${String(Math.floor(a)%60).padStart(2,'0')}s</span>`,remainingTimeInSeconds:t+a}},n=$('.aa-sovtimer-campaigns');fetchGet({url:a.url.ajaxUpdate}).then(i=>{i&&n.DataTable({language:a.dataTables.language,data:i,columns:[{data:'event_type'},{data:'solar_system_name_html'},{data:'constellation_name_html'},{data:'region_name_html'},{data:'defender_name_html'},{data:'adm'},{data:'start_time',render:{_:t=>null===t?'':moment(t).utc().format(a.datetimeFormat.datetimeLong),sort:a=>null===a?'':a}},{data:'remaining_time'},{data:'campaign_progress'},{data:'remaining_time_in_seconds'},{data:'solar_system_name'},{data:'constellation_name'},{data:'region_name'},{data:'defender_name'},{data:'active_campaign'}],columnDefs:[{visible:!1,targets:[0,9,10,11,12,13,14]},{width:'150px',targets:[8]}],order:[[6,'asc']],filterDropDown:{columns:[{idx:10,title:a.translation.dtFilter.system},{idx:11,title:a.translation.dtFilter.constellation},{idx:12,title:a.translation.dtFilter.region},{idx:13,title:a.translation.dtFilter.owner},{idx:14,title:a.translation.dtFilter.activeCampaign}],autoSize:!1,bootstrap:!0,bootstrap_version:5},createdRow:(e,n)=>{t.campaignsTotal.html(parseInt(t.campaignsTotal.html())+1),n.active_campaign===a.translation.no&&n.remaining_time_in_seconds<=a.upcomingTimerThreshold&&($(e).addClass('aa-sovtimer-upcoming-campaign'),t.campaignsUpcoming.html(parseInt(t.campaignsUpcoming.html())+1)),n.active_campaign===a.translation.yes&&($(e).addClass('aa-sovtimer-active-campaign'),t.campaignsActive.html(parseInt(t.campaignsActive.html())+1))},paging:!1,initComplete:()=>{setInterval(()=>{const a=n.DataTable();a.rows().every(t=>{const n=a.row(t),i=e(n.data().remaining_time_in_seconds);n.data({...n.data(),remaining_time_in_seconds:i.remainingTimeInSeconds,remaining_time:i.countdown})})},1e3),setInterval(()=>{fetchGet({url:a.url.ajaxUpdate}).then(e=>{n.DataTable().clear().rows.add(e).draw();const i=e.reduce((t,e)=>(t.total++,e.active_campaign===a.translation.no&&e.remaining_time_in_seconds<=a.upcomingTimerThreshold&&t.upcoming++,e.active_campaign===a.translation.yes&&t.active++,t),{total:0,upcoming:0,active:0});t.campaignsTotal.html(i.total),t.campaignsUpcoming.html(i.upcoming),t.campaignsActive.html(i.active)}).catch(a=>{console.error('Error updating campaign data:',a)})},3e4)}})}).catch(a=>{console.error('Error fetching campaign data:',a)})});
//# sourceMappingURL=aa-sov-timer.min.js.map