$(document).ready(()=>{'use strict';const a='undefined'!=typeof sovtimerJsSettingsOverride?objectDeepMerge(sovtimerJsSettingsDefaults,sovtimerJsSettingsOverride):sovtimerJsSettingsDefaults,t={campaignsTotal:$('.aa-sovtimer-campaigns-total'),campaignsUpcoming:$('.aa-sovtimer-campaigns-upcoming'),campaignsActive:$('.aa-sovtimer-campaigns-active')},e=(a,t=1)=>{const e=JSON.parse(JSON.stringify(a));return e[t]&&(e[t].content=[]),e},n=a=>{const t=a<0,e=t?'-':'',n='aa-sovtimer-remaining'+(t?' aa-sovtimer-timer-elapsed':'');a=Math.abs(a)+(t?1:-1);return{countdown:`<span class="${n}">${e}${Math.floor(a/86400)}d ${String(Math.floor(a/3600)%24).padStart(2,'0')}h ${String(Math.floor(a/60)%60).padStart(2,'0')}m ${String(Math.floor(a)%60).padStart(2,'0')}s</span>`,remainingTimeInSeconds:e+a}},i=e=>{const n=e.reduce((t,e)=>(t.total++,e.active_campaign===a.translation.no&&e.remaining_time_in_seconds<=a.upcomingTimerThreshold&&t.upcoming++,e.active_campaign===a.translation.yes&&t.active++,t),{total:0,upcoming:0,active:0});t.campaignsTotal.html(n.total),t.campaignsUpcoming.html(n.upcoming),t.campaignsActive.html(n.active)},r=$('.aa-sovtimer-campaigns');fetchGet({url:a.url.ajaxUpdate}).then(t=>{if(!t)return;new DataTable(r,{language:a.dataTables.language,data:t,dom:a.dataTables.dom,ordering:a.dataTables.ordering,columnControl:a.dataTables.columnControl,columns:[{data:{display:a=>a.solar_system_name_html,sort:a=>a.solar_system_name,filter:a=>a.solar_system_name}},{data:{display:a=>a.constellation_name_html,sort:a=>a.constellation_name,filter:a=>a.constellation_name}},{data:{display:a=>a.region_name_html,sort:a=>a.region_name,filter:a=>a.region_name}},{data:{display:a=>a.defender_name_html,sort:a=>a.defender_name,filter:a=>a.defender_name}},{data:'adm'},{data:{display:t=>t.start_time?moment(t.start_time).utc().format(a.datetimeFormat.datetimeLong):'',sort:a=>a.start_time||'',filter:a=>a.start_time||''}},{data:{display:a=>a.remaining_time,sort:a=>parseInt(a.remaining_time_in_seconds,10),filter:a=>parseInt(a.remaining_time_in_seconds,10)}},{data:{display:a=>a.campaign_progress,sort:a=>a.campaign_progress,filter:a=>a.active_campaign}}],columnDefs:[{targets:[4,5,6,7],columnControl:e(a.dataTables.columnControl,1)},{target:6,type:'string',width:175},{target:7,type:'string',width:175}],order:[[5,'asc']],createdRow:(t,e)=>{e.active_campaign===a.translation.no&&e.remaining_time_in_seconds<=a.upcomingTimerThreshold&&$(t).addClass('aa-sovtimer-upcoming-campaign'),e.active_campaign===a.translation.yes&&$(t).addClass('aa-sovtimer-active-campaign')},paging:!1,initComplete:()=>{const t=r.DataTable();i(t.rows().data().toArray()),setInterval(()=>{t.rows().every(a=>{const e=t.row(a),i=n(e.data().remaining_time_in_seconds);e.data({...e.data(),remaining_time_in_seconds:i.remainingTimeInSeconds,remaining_time:i.countdown})})},1e3),setInterval(()=>{fetchGet({url:a.url.ajaxUpdate}).then(a=>{t.clear().rows.add(a).draw(),i(a)}).catch(console.error)},3e4)}})}).catch(console.error)});
//# sourceMappingURL=aa-sov-timer.min.js.map